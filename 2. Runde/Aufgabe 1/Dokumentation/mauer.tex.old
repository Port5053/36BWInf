\documentclass[a4paper, 12pt]{scrartcl}

\usepackage[utf8]{inputenc}
\usepackage[T1]{fontenc}
\usepackage[ngerman]{babel}

\usepackage{amssymb}
\usepackage{amsmath}

\usepackage{float}
\usepackage[hidelinks]{hyperref}

\usepackage{tikz}

\allowdisplaybreaks
\newcommand{\numberthis}{\addtocounter{equation}{1}\tag{\theequation}}

\setlength{\parindent}{0pt}

\title{Aufgabe 1\\Die Kunst der Fuge\\Dokumentation}
\author{Kamal Abdellatif}
\date{}

\begin{document}
\maketitle
\section*{Obere Schranke}
Die Höhe einer Mauer von beliebigem $n$ ist nach oben beschränkt. Eine Mauer ist so breit wie die Summe der Längen $\ell$ aller Steine in einer Reihe. Da sich zwischen den Steinen nur die Reihenfolge ändert, entspricht die Breite jeder Reihe der Breite $w$ der Mauer.
\begin{equation}
	w = \sum_{\ell = 1}^n \ell = \frac{n(n+1)}{2}
\end{equation}
In jeder Reihe befinden sich genau $n-1$ Fugen, da auf jeden der $n$ Steine in der Reihe genau eine Fuge folgt, mit Außnahme des letzten Steins. Besitzt die Mauer eine Höhe $h$, so ist die Anzahl aller Fugen in der gesamten Mauer $h(n-1)$.\\
Eine Fuge nimmt entlang der Breite der Mauer eine bestimmte Position ein. Jede mögliche Position ist eine \emph{Spalte}, wobei die $i$-te Spalte den Abstand $i$ zum linken Mauerrand besitzt. Liegt auf einer Spalte eine Fuge, so ist die Spalte \emph{besetzt}.
\begin{figure}[H]
	\centering
	\begin{tikzpicture}
		\draw[ultra thick]
			(0, 0) rectangle ++(1, -1)
			(1, 0) rectangle ++(2, -1)
			(3, 0) rectangle ++(3, -1)
			(0, -1) rectangle ++(2, -1)
			(2, -1) rectangle ++(3, -1)
			(5, -1) rectangle ++(1, -1);

		\node[above] at (-.75, .25) {$i$};
		\foreach \i in {1,...,5} {
			\draw[dashed] (\i, .25) node[above] {\i} -- (\i, -2.25);
		}
	\end{tikzpicture}
	\caption{Spalten einer Mauer}
\end{figure}
Eine Mauer der Breite $w$ besitzt $w-1$ Spalten, da die erste Spalte Distanz $1$ und die letzte Spalte Distanz $w-1$ zum linken Rand aufweist.

\newpage

Hat eine Mauer keine sich überschneidenden Fugen, so kann jede Spalte von maximal einer Fuge belegt sein. Mit jeder hinzukommenden Reihe werden $n-1$ unbelegte Spalten mit Fugen besetzt. Ist es nicht mehr möglich, eine Reihe hinzuzufügen, ohne dass eine Überschneidung entsteht, ist die höhst mögliche Mauer erreicht. Diese maximale Höhe ergibt sich somit aus dem Quotienten aus der Anzahl aller Spalten und der Anzahl von Fugen pro Reihe.
\begin{align*}
	h(n-1) &\le w-1 \\
	&\le \frac{n(n+1)}{2} -1 \\
	h &\le \frac{\frac{1}{2}\,n(n+1)-1}{n-1} = \frac{\frac{1}{2}\,n(n-1)+n-1}{n-1} \\
	h &\le \frac{n}{2} + 1 \numberthis\label{eq:schranke}
\end{align*}
Nur für gerade $n$ nimmt diese obere Schranke ganzzahlige Werte an. Die Schranke ist genau dann erreicht, wenn jede Spalte durch genau eine Fuge belegt ist. Für ungerade $n$ ist die Schranke nie ganzzahlig, sodass sie nie erreicht werden kann. Demnach müssen im ungeraden Fall immer Spalten offen bleiben.
\begin{figure}[H]
	\centering
	\begin{tikzpicture}[scale=.75]
		\draw[very	thick] (0, 0) rectangle (1, 1) (1, 0) rectangle (4, 1) (4, 0) rectangle (6, 1) (6, 0) rectangle (11, 1) (11, 0) rectangle (15, 1) (0, 1) rectangle (2, 2) (2, 1) rectangle (5, 2) (5, 1) rectangle (9, 2) (9, 1) rectangle (14, 2) (14, 1) rectangle (15, 2) (0, 2) rectangle (3, 3) (3, 2) rectangle (7, 3) (7, 2) rectangle (8, 3) (8, 2) rectangle (13, 3) (13, 2) rectangle (15, 3);

		\draw[thick, dashed] (10, -.25) node[above] {} -- (10, 3.25);
		\draw[thick, dashed] (12, -.25) node[above] {} -- (12, 3.25);
	\end{tikzpicture}
	\caption{Offene Spalten bei ungeraden $n$}
\end{figure}
Die größte erreichbare Höhe $h_{max}$ für ungerade $n$ ist gleich der größten ganzen Zahl unter der Schranke. Aus Gleichung (\ref{eq:schranke}) ergibt sich
\begin{equation}
	h_{max} = \frac{n-1}{2}+1 = \frac{n+1}{2}
\end{equation}
Wird diese Höhe erreicht, so ist die Anzahl $r$ der noch offenen Spalten die Differenz aus der Anzahl aller Spalten $w-1$ und der Anzahl besetzter Spalten $h_{max}(n-1)$.
\begin{align*}
	r &= (w-1) - h_{max}(n-1) \\
	&= \left( \frac{n(n+1)}{2} - 1 \right) - \frac{n+1}{2}\,(n-1) \\
	&= \frac{(n+1)(n-1)+n-1}{2}-\frac{(n+1)(n-1)}{2} \\
	&= \frac{n-1}{2} \numberthis\label{eq:offen}
\end{align*}
Für eine Mauer ungeraden $n$ ohne Überschneidungen müssen mindestens $r = \frac{1}{2}(n-1)$ Spalten offen bleiben.

\section*{Vorbetrachtung}
Das Problem wird mit Backtracking gelöst. Es wird davon ausgegangen, dass die nach der oberen Schranke (\ref{eq:schranke}) gegebene größtmögliche Höhe $h = h_{max}$ immer erreichbar ist. Um eine Mauer $n$ zu lösen, wird von einer leeren Mauer der Dimensionen $w \times h$ ausgegangen. Ziel des Backtracking ist es, diese Mauer Stein für Stein zu füllen, ohne dass sich Fugen überschneiden.

Eine Mauer $W = \left\{ R_1,\ \dots,\ R_h \right\}$ besteht aus $h$ Reihen $R$. Während der Konstruktion der Mauer sind die Reihen nur teilweise gefüllt. Eine Reihe $R = \left\{ b_1,\ \dots,\ b_k \right\}$ enthält $k \leq n$ Steine einer bestimmten Länge $b$. Ein Stein $b_i$ ist der $i$-te Stein von links innerhalb der Reihe. Nur die Steine $\Sigma = \left\{ 1,\ \dots,\ n \right\}$ können in einer Reihe $R \subseteq \Sigma$ enthalten sein.

Jede Reihe $R$ besitzt eine Länge $\ell(R)$. Diese Länge ergibt sich aus der Summe aller in $R$ enthaltenen Steinlängen.
\begin{equation}
	\ell(R) = \sum_{b_i \in R} b_i
\end{equation}
Die Reihe endet in der $\ell$-ten Spalte. Diese Spalte wird als \emph{Endpunkt} der Reihe bezeichnet. Eine Reihe besitzt $k-1$ Fugen. Die Spalte $f_i$ der $i$-ten Fuge von links in einer Reihe $R$ ist die Teilsumme aller Steine bis dorthin.
\begin{equation}
	f_i = \sum_{j=1}^i b_j \qquad i < k
\end{equation}
Alle von Fugen durch eine Reihe $R$ besetzten Spalten sind in $F(R) = \left\{ f_1,\ \dots,\ f_{k-1} \right\}$ zusammengefasst.
\subsection*{Gerade Fälle}
In der Lösung einer Mauer geraden $n$ ist jede Spalte durch genau eine Fuge besetzt. Um diese Lösung zu konstruieren, werden die Spalten nacheinander von links nach rechts mit Fugen aufgefüllt. Mit jedem Rekursionsschritt wird eine Spalte gefüllt. Dazu wird ein Stein direkt an das rechte Ende einer Reihe angelegt.
\begin{figure}[H]
	\centering
	\begin{tikzpicture}[scale=.75]
		\draw[very thick] (0, 0) rectangle (15, 3);
		\draw[very thick, fill=white] (0, 0) rectangle (1, 1) (1, 0) rectangle (4, 1) (4, 0) rectangle (6, 1) (0, 1) rectangle (2, 2) (2, 1) rectangle (5, 2) (0, 2) rectangle (3, 3) (3.2, 2.2) rectangle (7.2, 3.2);
		\draw[thick, dashed] (7, -.5) -- (7, 3.5);
	\end{tikzpicture}
	\caption{Anlegen eines Steins}
\end{figure}
\end{document}